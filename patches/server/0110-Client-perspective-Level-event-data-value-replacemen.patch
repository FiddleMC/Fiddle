From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Martijn Muijsers <martijnmuijsers@live.nl>
Date: Thu, 4 Jan 2024 17:14:24 +0100
Subject: [PATCH] Client perspective - Level event data value replacements -
 Craft effect data value can be generic

As an expansion to the "Client perspective - Level event data value replacements - Data can be generic" patch,
this also allows the value returned by `CraftEffect.getDataValue` to have any type.

License: GPL-3.0 (https://www.gnu.org/licenses/gpl-3.0.html)
Fiddle - https://fiddlemc.org

diff --git a/src/main/java/org/bukkit/craftbukkit/CraftEffect.java b/src/main/java/org/bukkit/craftbukkit/CraftEffect.java
index 63f9735d356dafd579cee4423d3037eb4ed9b2c6..e5aa7c3062d41270ba7bcc44bc549ccc6ba32704 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftEffect.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftEffect.java
@@ -12,8 +12,10 @@ import org.bukkit.craftbukkit.util.CraftMagicNumbers;
 import org.bukkit.potion.Potion;
 
 public class CraftEffect {
-    public static <T> int getDataValue(Effect effect, T data) {
-        int datavalue;
+    // Fiddle start - client perspective - level event data value replacements - craft effect data value can be generic
+    public static <T> Object getDataValue(Effect effect, T data) {
+        Object datavalue;
+        // Fiddle end - client perspective - level event data value replacements - craft effect data value can be generic
         switch (effect) {
         case PARTICLES_SCULK_CHARGE: // Paper - add missing effects
         case VILLAGER_PLANT_GROW:
diff --git a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
index 0e670de77a7f9926e295e1dd63d909bed1a959ca..d56632563e638c9ad8eddc768fcb60910d81874d 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
@@ -1379,7 +1379,7 @@ public class CraftWorld extends CraftRegionAccessor implements World {
             Preconditions.checkArgument(effect.getData() == null || effect == Effect.ELECTRIC_SPARK, "Wrong kind of data for the %s effect", effect);
         }
 
-        int datavalue = CraftEffect.getDataValue(effect, data);
+        var datavalue = CraftEffect.getDataValue(effect, data); // Fiddle - client perspective - level event data value replacements - craft effect data value can be generic
         this.playEffect(loc, effect, datavalue, radius);
     }
 
diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
index 7dbaebb6d44a85a1586df64898bafbcf3f3b958e..5561b2255de683f319d0f2e4b710bda60070c0b9 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
@@ -876,7 +876,7 @@ public class CraftPlayer extends CraftHumanEntity implements Player {
             Preconditions.checkArgument(effect.getData() == null || effect == Effect.ELECTRIC_SPARK, "Wrong kind of data for the %s effect", effect);
         }
 
-        int datavalue = CraftEffect.getDataValue(effect, data);
+        var datavalue = CraftEffect.getDataValue(effect, data); // Fiddle - client perspective - level event data value replacements - craft effect data value can be generic
         this.playEffect(loc, effect, datavalue);
     }
 
