From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Martijn Muijsers <martijnmuijsers@live.nl>
Date: Thu, 4 Jan 2024 17:14:24 +0100
Subject: [PATCH] Client perspective - Level event data value replacements -
 Craft effect data value can be generic

As an expansion to the "Client perspective - Level event data value replacements - Data can be generic" patch,
this also allows the value returned by `CraftEffect.getDataValue` to have any type.

License: GPL-3.0 (https://www.gnu.org/licenses/gpl-3.0.html)
Fiddle - https://fiddlemc.org

diff --git a/src/main/java/org/bukkit/craftbukkit/CraftEffect.java b/src/main/java/org/bukkit/craftbukkit/CraftEffect.java
index 63f9735d356dafd579cee4423d3037eb4ed9b2c6..e5aa7c3062d41270ba7bcc44bc549ccc6ba32704 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftEffect.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftEffect.java
@@ -12,8 +12,10 @@ import org.bukkit.craftbukkit.util.CraftMagicNumbers;
 import org.bukkit.potion.Potion;
 
 public class CraftEffect {
-    public static <T> int getDataValue(Effect effect, T data) {
-        int datavalue;
+    // Fiddle start - client perspective - level event data value replacements - craft effect data value can be generic
+    public static <T> Object getDataValue(Effect effect, T data) {
+        Object datavalue;
+        // Fiddle end - client perspective - level event data value replacements - craft effect data value can be generic
         switch (effect) {
         case PARTICLES_SCULK_CHARGE: // Paper - add missing effects
         case VILLAGER_PLANT_GROW:
diff --git a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
index c3060d1d4d0caf369c6ab516cb424f45eb851019..1839259de85e5dfa590b06cef33fe8fcecd1052c 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftWorld.java
@@ -1400,7 +1400,7 @@ public class CraftWorld extends CraftRegionAccessor implements World {
             Preconditions.checkArgument(effect.getData() == null || effect == Effect.ELECTRIC_SPARK, "Wrong kind of data for the %s effect", effect);
         }
 
-        int datavalue = CraftEffect.getDataValue(effect, data);
+        var datavalue = CraftEffect.getDataValue(effect, data); // Fiddle - client perspective - level event data value replacements - craft effect data value can be generic
         this.playEffect(loc, effect, datavalue, radius);
     }
 
diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
index 6e5c102c3123e97156e050bcf2aad018da5c4d9e..772368d599e067b60e558399d8517bee73353109 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftPlayer.java
@@ -866,7 +866,7 @@ public class CraftPlayer extends CraftHumanEntity implements Player {
             Preconditions.checkArgument(effect.getData() == null || effect == Effect.ELECTRIC_SPARK, "Wrong kind of data for the %s effect", effect);
         }
 
-        int datavalue = CraftEffect.getDataValue(effect, data);
+        var datavalue = CraftEffect.getDataValue(effect, data); // Fiddle - client perspective - level event data value replacements - craft effect data value can be generic
         this.playEffect(loc, effect, datavalue);
     }
 
