From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Martijn Muijsers <martijnmuijsers@live.nl>
Date: Sun, 16 Jul 2023 13:30:05 +0200
Subject: [PATCH] Use cached registry index instead of doing lookup - Item

License: Fiddle Public License Agreement 1.0 (included in license/FPL-1.0.txt)
Fiddle - https://fiddlemc.org

diff --git a/src/main/java/net/minecraft/world/entity/player/StackedContents.java b/src/main/java/net/minecraft/world/entity/player/StackedContents.java
index 574ebb3a2fcd0e4e426a8a7ee88d722ed3b9c3f5..c65112aefc40fb35e8b56ec45a904e5c63da5a72 100644
--- a/src/main/java/net/minecraft/world/entity/player/StackedContents.java
+++ b/src/main/java/net/minecraft/world/entity/player/StackedContents.java
@@ -42,7 +42,7 @@ public class StackedContents {
     }
 
     public static int getStackingIndex(ItemStack stack) {
-        return BuiltInRegistries.ITEM.getId(stack.getItem());
+        return stack.getItem().getIndexInItemRegistry(); // Fiddle - cache registry indices as fields - use instead of lookup - item
     }
 
     boolean has(int itemId) {
diff --git a/src/main/java/net/minecraft/world/item/Item.java b/src/main/java/net/minecraft/world/item/Item.java
index 3cf9e66e8cd7084c1fcc05dcdfd4c147a968f3ad..716bf66e15021fe989193213ad220fe0a9f541b8 100644
--- a/src/main/java/net/minecraft/world/item/Item.java
+++ b/src/main/java/net/minecraft/world/item/Item.java
@@ -99,7 +99,7 @@ public class Item implements FeatureElement, ItemLike {
     // Fiddle end - cache registry indices as fields - item
 
     public static int getId(Item item) {
-        return item == null ? 0 : BuiltInRegistries.ITEM.getId(item);
+        return item == null ? 0 : item.getIndexInItemRegistry(); // Fiddle - cache registry indices as fields - use instead of lookup - item
     }
 
     public static Item byId(int id) {
