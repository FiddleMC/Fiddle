From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Martijn Muijsers <martijnmuijsers@live.nl>
Date: Thu, 1 Jun 2023 19:27:37 +0200
Subject: [PATCH] Modify Bukkit enums - Package source files

License: Fiddle Public License Agreement 1.0 (included in license/FPL-1.0.txt)
Fiddle - https://fiddlemc.org

diff --git a/build.gradle.kts b/build.gradle.kts
index 430c1f4d062e30e1a8920923c5a73b0f2977818a..10f617e1998a6ae6a5be8fe212e170b770cd031c 100644
--- a/build.gradle.kts
+++ b/build.gradle.kts
@@ -205,3 +205,30 @@ tasks.registerRunTask("runDev") {
     description = "Spin up a non-relocated Mojang-mapped test server"
     classpath(sourceSets.main.map { it.runtimeClasspath })
 }
+
+// Fiddle start - modify Bukkit enums - package source files
+val bukkitEnumClassesToLoad = arrayOf(
+    "org/bukkit/Material"
+)
+
+bukkitEnumClassesToLoad.forEach { classToLoad ->
+    tasks.register<Copy>("copyBukkitEnumSources") {
+        from(layout.projectDirectory.file("../$apiProjectName/src/main/java/$classToLoad.java"))
+        into(layout.buildDirectory.dir("tmp/copiedresources/enumsrc${
+            classToLoad.takeIf { it.contains('/') }?.let { "/${it.substring(0, it.lastIndexOf('/'))}" } ?: ""
+        }"))
+    }
+}
+
+tasks.processResources {
+    dependsOn("copyBukkitEnumSources")
+}
+
+sourceSets {
+    main {
+        resources {
+            srcDir(layout.buildDirectory.dir("tmp/copiedresources"))
+        }
+    }
+}
+// Fiddle end - modify Bukkit enums - package source files
