From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Martijn Muijsers <martijnmuijsers@live.nl>
Date: Wed, 12 Jul 2023 22:08:58 +0200
Subject: [PATCH] Modifiable Bukkit enums - Inject runtime versions - Material

License: Fiddle Public License Agreement 1.0 (included in license/FPL-1.0.txt)
Fiddle - https://fiddlemc.org

diff --git a/src/main/java/org/bukkit/Bukkit.java b/src/main/java/org/bukkit/Bukkit.java
index b243db56756c67cd2c41d7768898d01539f9260a..45417f956606031e24cdd40e6457ba264377e9cb 100644
--- a/src/main/java/org/bukkit/Bukkit.java
+++ b/src/main/java/org/bukkit/Bukkit.java
@@ -106,6 +106,18 @@ public final class Bukkit {
         }
 
         Bukkit.server = server;
+        // Fiddle start - modifiable Bukkit enums - inject runtime versions - Material
+        // Initialize the Material data field values
+        try {
+            var dataField = Material.class.getDeclaredField("data");
+            dataField.setAccessible(true);
+            for (Material material : Material.values()) {
+                dataField.set(material, material.computeData());
+            }
+        } catch (Exception e) {
+            throw new RuntimeException("Failed to initialize Material data field when setting singleton Server", e);
+        }
+        // Fiddle end - modifiable Bukkit enums - inject runtime versions - Material
         // Paper start - add git information
         server.getLogger().info(getVersionMessage());
     }
